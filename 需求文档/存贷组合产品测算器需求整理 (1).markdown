# 存贷组合产品测算器需求整理

## 1. 特别提示
- 本文档所有权归东莞银行所有，未经允许不得向任何非授权人员提供本文档的全部或部分内容，传递过程必须遵守“必需知道、最小授权”原则，若经发现必追究法律责任。
- 若本文档不属于您知悉范围，应立即销毁，不得保存、传输、复制、印刷或使用本文档之任何内容。

## 2. 需求相关信息
| 提出部门 | 提出人 | 版本号 | 修订内容 | 修订人 | 修订日期 |
|----------|--------|--------|----------|--------|----------|
|          |        | V0.1   | 初稿     | 卢梓健 | 2025/08/07 |

## 3. 业务背景
### 3.1. 背景及现状
套利是金融市场中利用资产价格差异获取无风险或低风险利润的交易策略，其核心逻辑是通过同时进行“低买高卖”的反向操作，锁定价差收益，理论上不依赖对资产未来价格走势的预测。

### 3.2. 目标
- 客户利用产品间的价差，锁定收益。
- 银行设计产品组合收益可视化计算工具，帮助客户经理营销客户。

## 4. 总体描述
### 4.1. 业务方案概述
存贷组合产品测算器是一个用于帮助客户经理计算客户购买产品组合收益的工具，支持存款、贷款和外汇（即期、远期、掉期）产品的录入、修改、删除及收益汇总。

### 4.2. 业务流程说明
1. 客户经理进入主页面，点击“添加新产品”，输入产品要素，点击保存并返回。
2. 系统按添加顺序从旧到新展示产品列表，每项产品包含“编辑”和“更多”两个操作按钮。
3. 点击“更多”按钮，在列表中展开产品详情信息；点击“编辑”按钮，进入修改产品页，可修改或删除产品要素。
4. 添加所有产品后，点击“汇总收益”，进入汇总收益页，查看各币种收益。
5. 客户经理输入各币种对人民币汇率，系统自动计算人民币汇总收益。

### 4.3. 业务交易规则
1. 系统按添加顺序从旧到新展示产品。
2. 汇总收益页面中，各币种收益 = 对应币种存款利息 - 贷款利息 + 掉期期末收益 - 手续费金额，若某币种收益为0则不展示。

### 4.4. 性能与兼容性
- 产品列表支持最多100条产品记录，加载时间不超过2秒。
- 兼容主流浏览器（Chrome、Safari、Edge）及移动端（iOS、Android）。
- 界面支持响应式设计，适配屏幕宽度320px-1920px。

## 5. 功能清单
### 5.1. 存贷组合产品测算器
#### 5.1.1. 功能描述
- **功能说明**：客户经理根据客户购买的产品组合，输入相关产品要素，计算所有产品的汇总收益。
- **功能路径**：莞银易-待定
- **人员及权限**：操作权限为行员。
- **操作步骤**：
  1. 进入主页面，点击“添加新产品”，输入产品要素，点击保存并返回。
  2. 系统按添加顺序从旧到新展示产品列表，每项产品包含“编辑”和“更多”按钮。
  3. 点击“更多”按钮，在列表中展开产品详情；点击“编辑”按钮，进入修改产品页，可修改或删除产品要素。
  4. 添加完成所有产品后，点击“汇总收益”，查看各币种收益；输入各币种对人民币汇率，系统计算人民币汇总收益。

## 6. 需求说明
### 6.1. 统一校验规则
- **金额字段通用规则**：所有金额相关字段（包括金额、卖出金额、买入金额、近端/远端金额、手续费金额）需为正数，保留2位小数，范围0.01-999999999.99，输入错误时提示“金额需为正数且保留2位小数”。
- **币种字段通用规则**：所有币种相关字段（包括存款/贷款币种、手续费币种、卖出/买入币种、近端/远端卖出/买入币种）支持币种：AUD, CAD, HKD, JPY, SGD, GBP, USD, EUR, CNY, CHF，未选择时提示“请选择币种”。默认币种为人民币（CNY），币种选择下拉框需从系统预配置的币种列表中动态加载。

### 6.2. 主页面
#### 6.2.1. 功能描述
主页面展示已添加的产品列表，支持查看产品详情、编辑产品、添加新产品和进入汇总收益页。点击“编辑”按钮，系统加载选中产品的现有数据，跳转至修改产品页进行反显。

#### 6.2.2. 输入输出要素
| 要素名称 | 要素属性 | 要素级规则说明 | 格式/校验规则 |
|----------|----------|----------------|---------------|
| **存款产品** | | | |
| 产品类型 | 输出 | 显示“存款” | |
| 产品名称 | 输出 | | 长度不超过50字符 |
| 利息 | 输出（利息金额） | | 保留2位小数 |
| **存款列表** | | | |
| 更多 | 按钮 | 点击在列表中展开详情，包括以下字段 | |
| 编辑 | 按钮 | 点击跳转至修改产品页，加载产品数据 | |
| 币种 | 输出 | | 统一币种规则 |
| 金额 | 输出 | | 统一金额规则 |
| 利率 | 输出 | | 保留2位小数 |
| 期限 | 输出 | | 整数，单位为天 |
| 利息 | 输出 | | 保留2位小数 |
| 本息 | 输出 | | 保留2位小数 |
| 手续费币种 | 输出 | | 统一币种规则 |
| 手续费金额 | 输出 | | 统一金额规则 |
| **贷款产品** | | | |
| 产品类型 | 输出 | 显示“贷款” | |
| 产品名称 | 输出 | | 长度不超过50字符 |
| 利息 | 输出（利息金额） | | 保留2位小数 |
| **贷款列表** | | | |
| 更多 | 按钮 | 点击在列表中展开详情，包括以下字段 | |
| 编辑 | 按钮 | 点击跳转至修改产品页，加载产品数据 | |
| 币种 | 输出 | | 统一币种规则 |
| 金额 | 输出 | | 统一金额规则 |
| 利率 | 输出 | | 保留2位小数 |
| 期限 | 输出 | | 整数，单位为天 |
| 利息 | 输出 | | 保留2位小数 |
| 本息 | 输出 | | 保留2位小数 |
| 手续费币种 | 输出 | | 统一币种规则 |
| 手续费金额 | 输出 | | 统一金额规则 |
| **外汇-即期产品** | | | |
| 产品类型 | 输出 | 显示“外汇” | |
| 产品名称 | 输出 | 显示“即期” | |
| **外汇即期列表** | | | |
| 更多 | 按钮 | 点击在列表中展开详情，包括以下字段 | |
| 编辑 | 按钮 | 点击跳转至修改产品页，加载产品数据 | |
| 卖出币种 | 输出 | | 统一币种规则 |
| 买入币种 | 输出 | | 统一币种规则 |
| 卖出金额 | 输出 | | 统一金额规则 |
| 汇率 | 输出 | | 保留2位小数 |
| 买入金额 | 输出 | | 统一金额规则 |
| 手续费币种 | 输出 | | 统一币种规则 |
| 手续费金额 | 输出 | | 统一金额规则 |
| **外汇-远期产品** | | | |
| 产品类型 | 输出 | 显示“外汇” | |
| 产品名称 | 输出 | 显示“远期” | |
| **外汇远期列表** | | | |
| 更多 | 按钮 | 点击在列表中展开详情，包括以下字段 | |
| 编辑 | 按钮 | 点击跳转至修改产品页，加载产品数据 | |
| 卖出币种 | 输出 | | 统一币种规则 |
| 买入币种 | 输出 | | 统一币种规则 |
| 卖出金额 | 输出 | | 统一金额规则 |
| 汇率 | 输出 | | 保留2位小数 |
| 买入金额 | 输出 | | 统一金额规则 |
| 手续费币种 | 输出 | | 统一币种规则 |
| 手续费金额 | 输出 | | 统一金额规则 |
| **外汇-掉期产品** | | | |
| 产品类型 | 输出 | 显示“外汇” | |
| 产品名称 | 输出 | 显示“掉期” | |
| 期末收益 | 输出（金额） | | 保留2位小数 |
| **外汇掉期列表** | | | |
| 更多 | 按钮 | 点击在列表中展开详情，包括以下字段 | |
| 编辑 | 按钮 | 点击跳转至修改产品页，加载产品数据 | |
| 近端卖出币种 | 输出 | | 统一币种规则 |
| 近端买入币种 | 输出 | | 统一币种规则 |
| 近端卖出金额 | 输出 | | 统一金额规则 |
| 近端汇率 | 输出 | | 保留2位小数 |
| 近端买入金额 | 输出 | | 统一金额规则 |
| 远端卖出币种 | 输出 | | 统一币种规则 |
| 远端买入币种 | 输出 | | 统一币种规则 |
| 远端卖出金额 | 输出 | | 统一金额规则 |
| 远端汇率 | 输出 | | 保留2位小数 |
| 远端买入金额 | 输出 | | 统一金额规则 |
| 期末收益 | 输出 | 币种为近端买入币种 | 保留2位小数 |
| 手续费币种 | 输出 | | 统一币种规则 |
| 手续费金额 | 输出 | | 统一金额规则 |
| **添加新产品** | 按钮 | 跳转至添加新产品页 | |
| **汇总收益** | 按钮 | 跳转至汇总收益页 | |

### 6.3. 添加新产品页
#### 6.3.1. 功能描述
用于录入新产品的详细信息，支持存款、贷款和外汇（即期、远期、掉期）产品。

#### 6.3.2. 输入输出要素
| 要素名称 | 要素属性 | 要素级规则说明 | 格式/校验规则 |
|----------|----------|----------------|---------------|
| 产品种类 | 下拉框，必输 | 选项：存款、贷款、外汇 | 必须选择一项，未选择时提示“请选择产品种类” |
| 产品名称 | 必输/下拉框 | 若产品种类为存款或贷款，则为文本框必输；若为外汇，则为下拉框（即期、远期、掉期） | 文本框：非空，长度1-50字符；下拉框：必须选择一项，未选择时提示“请选择产品名称” |
| **存款列表** | | | |
| 币种 | 下拉框，必输 | | 统一币种规则 |
| 金额 | 必输 | | 统一金额规则 |
| 利率 | 必输 | | 正数，保留2位小数，范围0.01-99.99，输入错误时提示“利率需为0.01%-99.99%” |
| 期限 | 必输 | | 正整数，单位为天，范围1-1825（5年），输入错误时提示“期限需为1-1825天的正整数” |
| 利息 | 输出 | 利息 = 金额 * 利率 * 期限 / 100 | 保留2位小数 |
| 本息 | 输出 | 本息 = 金额 + 利息 | 保留2位小数 |
| 手续费币种 | 下拉框，可输 | | 统一币种规则，若为空则无手续费 |
| 手续费金额 | 可输 | | 统一金额规则 |
| **贷款列表** | | | |
| 币种 | 下拉框，必输 | | 统一币种规则 |
| 金额 | 必输 | | 统一金额规则 |
| 利率 | 必输 | | 正数，保留2位小数，范围0.01-99.99，输入错误时提示“利率需为0.01%-99.99%” |
| 期限 | 必输 | | 正整数，单位为天，范围1-1825（5年），输入错误时提示“期限需为1-1825天的正整数” |
| 利息 | 输出 | 利息 = 金额 * 利率 * 期限 / 100 | 保留2位小数 |
| 本息 | 输出 | 本息 = 金额 + 利息 | 保留2位小数 |
| 手续费币种 | 下拉框，可输 | | 统一币种规则，若为空则无手续费 |
| 手续费金额 | 可输 | | 统一金额规则 |
| **外汇即期列表** | | | |
| 卖出币种 | 下拉框，必输 | | 统一币种规则 |
| 买入币种 | 下拉框，必输 | | 统一币种规则 |
| 卖出金额 | 必输 | | 统一金额规则 |
| 汇率 | 必输 | | 正数，保留2位小数，范围0.01-9999.99，输入错误时提示“汇率需为正数” |
| 买入金额 | 必输 | | 统一金额规则 |
| 手续费币种 | 下拉框，可输 | | 统一币种规则，若为空则无手续费 |
| 手续费金额 | 可输 | | 统一金额规则 |
| **外汇远期列表** | | | |
| 卖出币种 | 下拉框，必输 | | 统一币种规则 |
| 买入币种 | 下拉框，必输 | | 统一币种规则 |
| 卖出金额 | 必输 | | 统一金额规则 |
| 汇率 | 必输 | | 正数，保留2位小数，范围0.01-9999.99，输入错误时提示“汇率需为正数” |
| 买入金额 | 必输 | | 统一金额规则 |
| 手续费币种 | 下拉框，可输 | | 统一币种规则，若为空则无手续费 |
| 手续费金额 | 可输 | | 统一金额规则 |
| **外汇掉期列表** | | | |
| 近端卖出币种 | 下拉框，必输 | | 统一币种规则 |
| 近端买入币种 | 下拉框，必输 | | 统一币种规则 |
| 近端卖出金额 | 必输 | | 统一金额规则 |
| 近端汇率 | 必输 | | 正数，保留2位小数，范围0.01-9999.99，输入错误时提示“近端汇率需为正数” |
| 近端买入金额 | 输出 | 近端买入金额 = 近端卖出金额 * 近端汇率 | 统一金额规则 |
| 远端卖出币种 | 下拉框，必输 | | 统一币种规则 |
| 远端买入币种 | 下拉框，必输 | | 统一币种规则 |
| 远端买入金额 | 输出 | 远端买入金额 = 近端卖出金额 | 统一金额规则 |
| 远端汇率 | 必输 | | 正数，保留2位小数，范围0.01-9999.99，输入错误时提示“远端汇率需为正数” |
| 远端卖出金额 | 输出 | 远端卖出金额 = 远端买入金额 * 远端汇率 | 统一金额规则 |
| 期末收益 | 输出 | 币种为近端买入币种，期末收益 = 远端卖出金额 - 近端买入金额 | 保留2位小数 |
| 手续费币种 | 下拉框，可输 | | 统一币种规则，若为空则无手续费 |
| 手续费金额 | 可输 | | 统一金额规则 |
| 保存并返回 | 按钮 | 保存产品信息，返回主页面 | |
| 取消 | 按钮 | 取消当前输入，不保存数据，返回主页面 | |

### 6.4. 修改产品页
#### 6.4.1. 功能描述
用于修改或删除已有产品的详细信息，字段与添加新产品页一致，支持反显和修改。

#### 6.4.2. 输入输出要素
| 要素名称 | 要素属性 | 要素级规则说明 | 格式/校验规则 |
|----------|----------|----------------|---------------|
| 产品种类 | 输出 | 反显，不可修改 | |
| **存款产品** | | | |
| 币种 | 下拉框，必输 | 反显可修改 | 统一币种规则 |
| 金额 | 必输 | 反显可修改 | 统一金额规则 |
| 利率 | 必输 | 反显可修改 | 正数，保留2位小数，范围0.01-99.99，输入错误时提示“利率需为0.01%-99.99%” |
| 期限 | 必输 | 反显可修改 | 正整数，单位为天，范围1-1825（5年），输入错误时提示“期限需为1-1825天的正整数” |
| 利息 | 输出 | 利息 = 金额 * 利率 * 期限 / 100 | 保留2位小数 |
| 本息 | 输出 | 本息 = 金额 + 利息 | 保留2位小数 |
| 手续费币种 | 下拉框，可输 | 反显可修改 | 统一币种规则，若为空则无手续费 |
| 手续费金额 | 可输 | 反显可修改 | 统一金额规则 |
| **贷款产品** | | | |
| 币种 | 下拉框，必输 | 反显可修改 | 统一币种规则 |
| 金额 | 必输 | 反显可修改 | 统一金额规则 |
| 利率 | 必输 | 反显可修改 | 正数，保留2位小数，范围0.01-99.99，输入错误时提示“利率需为0.01%-99.99%” |
| 期限 | 必输 | 反显可修改 | 正整数，单位为天，范围1-1825（5年），输入错误时提示“期限需为1-1825天的正整数” |
| 利息 | 输出 | 利息 = 金额 * 利率 * 期限 / 100 | 保留2位小数 |
| 本息 | 输出 | 本息 = 金额 + 利息 | 保留2位小数 |
| 手续费币种 | 下拉框，可输 | 反显可修改 | 统一币种规则，若为空则无手续费 |
| 手续费金额 | 可输 | 反显可修改 | 统一金额规则 |
| **外汇即期产品** | | | |
| 卖出币种 | 下拉框，必输 | 反显可修改 | 统一币种规则 |
| 买入币种 | 下拉框，必输 | 反显可修改 | 统一币种规则 |
| 卖出金额 | 必输 | 反显可修改 | 统一金额规则 |
| 汇率 | 必输 | 反显可修改 | 正数，保留2位小数，范围0.01-9999.99，输入错误时提示“汇率需为正数” |
| 买入金额 | 必输 | 反显可修改 | 统一金额规则 |
| 手续费币种 | 下拉框，可输 | 反显可修改 | 统一币种规则，若为空则无手续费 |
| 手续费金额 | 可输 | 反显可修改 | 统一金额规则 |
| **外汇远期产品** | | | |
| 卖出币种 | 下拉框，必输 | 反显可修改 | 统一币种规则 |
| 买入币种 | 下拉框，必输 | 反显可修改 | 统一币种规则 |
| 卖出金额 | 必输 | 反显可修改 | 统一金额规则 |
| 汇率 | 必输 | 反显可修改 | 正数，保留2位小数，范围0.01-9999.99，输入错误时提示“汇率需为正数” |
| 买入金额 | 必输 | 反显可修改 | 统一金额规则 |
| 手续费币种 | 下拉框，可输 | 反显可修改 | 统一币种规则，若为空则无手续费 |
| 手续费金额 | 可输 | 反显可修改 | 统一金额规则 |
| **外汇掉期产品** | | | |
| 近端卖出币种 | 下拉框，必输 | 反显可修改 | 统一币种规则 |
| 近端买入币种 | 下拉框，必输 | 反显可修改 | 统一币种规则 |
| 近端卖出金额 | 必输 | 反显可修改 | 统一金额规则 |
| 近端汇率 | 必输 | 反显可修改 | 正数，保留2位小数，范围0.01-9999.99，输入错误时提示“近端汇率需为正数” |
| 近端买入金额 | 输出 | 近端买入金额 = 近端卖出金额 * 近端汇率 | 统一金额规则 |
| 远端卖出币种 | 下拉框，必输 | 反显可修改 | 统一币种规则 |
| 远端买入币种 | 下拉框，必输 | 反显可修改 | 统一币种规则 |
| 远端买入金额 | 输出 | 远端买入金额 = 近端卖出金额 | 统一金额规则 |
| 远端汇率 | 必输 | 反显可修改 | 正数，保留2位小数，范围0.01-9999.99，输入错误时提示“远端汇率需为正数” |
| 远端卖出金额 | 输出 | 远端卖出金额 = 远端买入金额 * 远端汇率 | 统一金额规则 |
| 期末收益 | 输出 | 币种为近端买入币种，期末收益 = 远端卖出金额 - 近端买入金额 | 保留2位小数 |
| 手续费币种 | 下拉框，可输 | 反显可修改 | 统一币种规则，若为空则无手续费 |
| 手续费金额 | 可输 | 反显可修改 | 统一金额规则 |
| 保存并返回 | 按钮 | 保存修改，返回主页面 | |
| 删除 | 按钮 | 删除产品，返回主页面 | 弹出确认提示“是否确认删除该产品？” |
| 取消 | 按钮 | 取消当前输入，不保存数据，返回主页面 | |

### 6.5. 汇总收益页
#### 6.5.1. 功能描述
汇总收益页动态展示所有产品涉及的币种收益，并支持输入各币种对人民币汇率，计算人民币汇总收益。币种收益列表根据添加的产品自动生成，重复币种合并计算。

#### 6.5.2. 输入输出要素
| 要素名称 | 要素属性 | 要素级规则说明 | 格式/校验规则 |
|----------|----------|----------------|---------------|
| 币种收益 | 输出 | 动态生成，基于添加产品的币种，重复币种合并 | 保留2位小数 |
| 币种对人民币汇率 | 可输 | | 正数，保留2位小数，范围0.01-9999.99，输入错误时提示“汇率需为正数” |
| 人民币汇总收益 | 输出 | 人民币汇总收益 = 各币种收益 * 对应人民币汇率之和 | 保留2位小数 |
| 取消 | 按钮 | 取消当前输入，不保存数据，返回主页面 | |

### 6.6. 界面设计说明
- **主页面**：
  - 产品列表按添加时间从旧到新排序，显示产品类型、产品名称、利息/期末收益。
  - 每项产品右侧包含“编辑”和“更多”按钮，点击“更多”在列表中展开详情（折叠式，无需跳转新页面，展开动画时长0.3秒）。
  - 支持分页，每页显示10条记录，包含上一页/下一页按钮。
  - 页面底部包含“添加新产品”和“汇总收益”按钮，按钮宽度固定，间距10px。
- **添加新产品页/修改产品页**：
  - 表单布局，产品种类下拉框置顶，根据选择动态显示存款、贷款或外汇相关字段。
  - 必输字段标红星（*），输入错误时在字段下方显示红色提示文字（字体12px）。
  - 底部按钮从左至右依次为“保存并返回”“取消”（修改产品页额外包含“删除”按钮），按钮宽度120px，间距10px。
- **汇总收益页**：
  - 动态显示币种收益列表（表格形式），每行包含币种名称、收益金额、汇率输入框。
  - 表格列宽分别为150px（币种）、200px（收益金额）、200px（汇率输入框）。
  - 底部显示人民币汇总收益（高亮显示，背景色#FFE4B5，字体加粗），包含“取消”按钮。
- **错误提示样式**：
  - 错误提示以红色文字显示于字段下方，字体12px，显示时间持续直到用户修正输入。
  - 必输字段未填写时，点击“保存并返回”显示提示“请填写所有必输字段”。
- 参考图：`image1.jpeg`（建议开发人员基于参考图优化布局，确保适配移动端和桌面端）。

## 7. 交易检查
### 7.1. 通用检查项
- 所有必输字段不得为空，点击“保存并返回”时未填写必输字段，提示“请填写所有必输字段”。
- 金额字段（金额、卖出金额、买入金额、近端/远端金额、手续费金额）需符合统一金额规则。
- 币种字段（存款/贷款币种、手续费币种、卖出/买入币种、近端/远端卖出/买入币种）需符合统一币种规则。
- 利率需为正数，保留2位小数，范围0.01-99.99，输入错误时提示“利率需为0.01%-99.99%”。
- 期限需为正整数，单位为天，范围1-1825，输入错误时提示“期限需为1-1825天的正整数”。
- 汇率（包括近端汇率、远端汇率）需为正数，保留2位小数，范围0.01-9999.99，输入错误时提示“汇率需为正数”。
- 产品名称（存款/贷款）长度需为1-50字符，输入错误时提示“产品名称长度需为1-50字符”。

### 7.2. 柜面相关检查项
- 掉期产品中，近端买入币种与远端卖出币种需一致（如均为USD），不一致时提示“近端买入币种与远端卖出币种必须一致”。
- 汇总收益页的币种对人民币汇率需为正数，保留2位小数，范围0.01-9999.99，输入错误时提示“汇率需为正数”。

## 8. 柜面相关配置
### 8.1. 授权配置
- 仅行员具有操作权限，需登录系统验证身份。
- 待定其他权限配置（如管理员权限）。

### 8.2. 打印凭证
- 支持打印产品列表和汇总收益页，格式待定。

### 8.3. 勾对信息
- 系统记录每项产品的添加/修改/删除操作日志，包含操作人、时间、操作类型，具体字段待定。

### 8.4. 验印控制支付配置
- 暂无支付功能，相关配置待定。